import pandas as pd
import numpy as np
import plotly.express as px
import plotly.graph_objects as go
from app.model import g, Trial
from scipy import stats
from scipy.stats import lognorm
from sim_tools.distributions import (Exponential, Lognormal, Uniform)

##### Visualising lognormal distributions - visualising a particular distribution
# Given mean and std in real space
mean = 215
std = 374.1

# Convert to shape (s), location (loc), and scale parameters
los_dist = Lognormal(mean, std, random_seed = 1)

# Generate x values
x = np.linspace(1, mean + 4*std, 500)
pdf = lognorm.pdf(x, s=sigma, scale=np.exp(mu))

# Plot
fig = go.Figure()
fig.add_trace(go.Scatter(x=x, y=pdf, mode='lines', name='Lognormal PDF'))
fig.update_layout(template='plotly_white', title='Lognormal Distribution')
fig.show()

#### Visualising a loop of distributions
# Given mean and std in real space
mean_list = list(range(190, 220, 5))
std_list = [x * 1.74 for x in mean_list]

for i in range(len(mean_list)):

# Convert to shape (s), location (loc), and scale parameters
    phi = np.sqrt(std_list[i]**2 + mean_list[i]**2)
    sigma = np.sqrt(np.log((phi**2) / (mean_list[i]**2)))
    mu = np.log(mean_list[i]**2 / phi)

    # Generate x values
    x = np.linspace(1, mean_list[i] + 4*std_list[i], 500)
    pdf = lognorm.pdf(x, s=sigma, scale=np.exp(mu))

    # Plot
    fig = go.Figure()
    fig.add_trace(go.Scatter(x=x, y=pdf, mode='lines', name='Lognormal PDF'))
    fig.update_layout(template='plotly_white', title=f'Lognormal Distribution Mean {mean_list[i]} STD {std_list[i]}')
    fig.show()